<div class="min-h-screen py-20 px-4 bg-gradient-to-b from-stone-50 via-amber-50/30 to-stone-100"
     data-controller="envelope rsvp-form"
     data-rsvp-form-guest-ids-value="<%= @guests.map(&:id).to_json %>">
  <div class="max-w-2xl mx-auto">
    <%# Header %>
    <div class="text-center mb-16 animate-fade-in-up">
      <%= render "public/shared/divider" %>
      <div class="mb-8"></div>
      <h1 class="text-6xl mb-6 tracking-wide font-display font-light text-stone-800">
        RSVP
      </h1>
      <p class="text-sm tracking-wider text-stone-500 font-light">
        Select the envelope to reveal your invitation
      </p>
    </div>

    <%= render "public/shared/flash_messages" %>

    <%# Envelope %>
    <%= render "public/rsvps/envelope" %>

    <%# Full RSVP Form (hidden initially) %>
    <div class="hidden" data-envelope-target="form">
      <div class="rsvp-form-card animate-fade-in-up">
        <div class="mb-12">
          <h2 class="text-3xl mb-2 font-display font-light text-stone-800">
            <%= @household.name %>
          </h2>
          <p class="text-stone-500 font-light">
            Please respond for each guest in your party
          </p>
          <% if current_wedding.rsvp_deadline %>
            <p class="text-sm mt-2 text-stone-400 font-light">
              Kindly respond by <%= current_wedding.rsvp_deadline_formatted %>
            </p>
          <% end %>
        </div>

        <%= form_with url: public_rsvp_path(@guest.invite_code), method: :patch, data: { turbo: false } do |f| %>
          <% @guests.each_with_index do |guest, index| %>
            <%= render "public/rsvps/guest_fields", guest: guest, index: index %>
          <% end %>

          <div class="pt-12">
            <%= f.submit "Submit Response", class: "rsvp-submit" %>
          </div>
        <% end %>
      </div>
    </div>

    <%# Decorative corners (desktop only) %>
    <div class="hidden md:block absolute top-20 left-10 w-24 h-24 border-l border-t border-stone-200/50"></div>
    <div class="hidden md:block absolute bottom-20 right-10 w-24 h-24 border-r border-b border-stone-200/50"></div>
  </div>
</div>
